Extract and consolidate structured purchase order data (lighting products trading context) from PyMuPDF-parsed text of customer PO PDFs into a single plain text document formatted for Odoo ERP sales order import
Background: PDFs may contain multiple pages, mixed tables, headers, and revisions; requirement is a coherent, page-break-free consolidated text
Input: PyMuPDF parsed text blocks with reading order and table structures (rows, columns, spans) if available
Output: One continuous plain text document, no metadata/JSON/XML/CSV, no page break markers, no invented data, only parsed content
Output format (exact order and structure, example in "" for illustration only):
    self.company = "Ampco Products Limited"
    self.customer = "Focal Point, LLC"
    self.x_studio_customer_po_number = "PO-001"
    self.order_lines = [
        {
            "product": "A36773-04",
            "quantity": "12",
            "x_studio_delivery_date": "2025-01-15",
        },
        {
            "product": "694465",
            "quantity": "800",
            "x_studio_delivery_date": "2025-02-10",
        },
        {
            "product": "443004",
            "quantity": "1500",
            "x_studio_delivery_date": "2025-03-05",
        },
    ]
    … continue numbering sequentially for all product present

Field Mapping for Odoo:
Company: From Company/Supplier/Vendor section or address in Hong Kong (exclude overseas names), or included “Ampco”.
Customer: From Customer/Sold To/Bill To section or overseas address (exclude “Ampco”).
Customer PO Number: From PO No./Customer PO Number/Purchase Order No.
Product: From Item/Product Code/Part No.; keep only short code, remove “*” or description  (e.g., “*287LC7” → “287LC7”).
Quantity: From Qty/QTY/Quantity Ordered; numeric only.
Delivery Date: From Requested/Required/Ship/Delivery Date; standardize to YYYY-MM-DD.

Extraction Rules:
Detect headers using synonyms above.
Identify company and customer by address: Hong Kong/Ampco → Company; Overseas → Customer.
If "Good Earth Lighting" appears anywhere in the document, always set it as self.customer with highest priority regardless of other address-based rules.
Merge tables and pages in reading order; remove formatting marks or symbols.
Normalize dates and numbers; ensure one continuous, gap-free order list.
Every order line must include product, quantity, and delivery date; fill using the most relevant parsed value if label variations exist.
Output one plain text block following the defined field order and syntax, ready for Odoo import without interruption.
Final output must contain all mandatory fields (company, customer, PO number, and at least one valid order line) or be considered incomplete.

Output: 
Single plain text document, line-break delimited, no markup or metadata, following the defined sequence exactly.
